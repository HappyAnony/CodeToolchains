

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>示例脚本 &mdash; CodeToolchains 1.0.0 文档</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="../../../genindex.html"/>
        <link rel="search" title="搜索" href="../../../search.html"/>
    <link rel="top" title="CodeToolchains 1.0.0 文档" href="../../../index.html"/>
        <link rel="up" title="脚本示例" href="index.html"/>
        <link rel="next" title="实用脚本" href="1-usescript.html"/>
        <link rel="prev" title="脚本示例" href="index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> CodeToolchains
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../1-TextEdit/index.html">文本编辑器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2-VerControl/index.html">版本控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../3-IDE/index.html">IDE集成开发环境</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Linux工具集</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../1-shellenv/index.html">shell环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2-shellcmd/index.html">shell命令</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">shell编程</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../1-syntax/index.html">语法基础</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2-library/index.html">常用类库</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">脚本示例</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">示例脚本</a></li>
<li class="toctree-l4"><a class="reference internal" href="1-usescript.html">实用脚本</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../5-Wildcard/index.html">通配机制</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../6-DataBase/index.html">数据库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../7-WebArch/index.html">网站架构</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CodeToolchains</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Linux工具集</a> &raquo;</li>
        
          <li><a href="../index.html">shell编程</a> &raquo;</li>
        
          <li><a href="index.html">脚本示例</a> &raquo;</li>
        
      <li>示例脚本</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/4-Linux/3-shellprogram/3-sample/0-smallscript.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>示例脚本<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<ul class="simple">
<li>写一个脚本，实现如下功能：让用户通过键盘输入一个用户名，如果用户存在，就显示其用户名和UID，否则，就显示用户不存在</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">read</span> -p <span class="s2">&quot;please input userName: &quot;</span> userName
<span class="k">if</span> grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">\&gt;&quot;</span> /etc/passwd <span class="p">&amp;</span>&gt; /dev/null<span class="p">;</span><span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> :`id -u </span><span class="nv">$userName</span><span class="s2">`&quot;</span><span class="p">;</span>
<span class="k">else</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is not exist !!&quot;</span><span class="p">;</span>
<span class="k">fi</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一脚本，实现如下功能</p>
<blockquote>
<div><ul class="simple">
<li>1、让用户通过键盘输入一个用户名，如果用户不存在就退出</li>
<li>2、如果用户的UID大于等于500，就说明它是普通用户</li>
<li>3、否则，就说明这是管理员或系统用户</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">read</span> -p <span class="s2">&quot;please input userName: &quot;</span> userName

<span class="k">if</span> ! grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">\&gt;&quot;</span> /etc/passwd <span class="p">&amp;</span>&gt; /dev/null<span class="p">;</span><span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2">  not exist&quot;</span>
        <span class="nb">exit</span> <span class="m">6</span>
<span class="k">fi</span>

<span class="nv">uid</span><span class="o">=</span><span class="sb">`</span>id -u <span class="nv">$userName</span><span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$uid</span> -ge <span class="m">500</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;The </span><span class="nv">$userName</span><span class="s2"> is common user&quot;</span>
<span class="k">else</span>
        <span class="nb">echo</span> <span class="s2">&quot;The </span><span class="nv">$userName</span><span class="s2"> is system user&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一脚本，实现如下功能</p>
<blockquote>
<div><ul class="simple">
<li>1、让用户通过键盘输入一个用户名，如果用户不存在就退出</li>
<li>2、如果其UID等于其GID，就说它是个”good guy”</li>
<li>3、否则，就说它是个”bad guy”</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nb">read</span> -p <span class="s2">&quot;please input userName: &quot;</span> userName

<span class="k">if</span> ! grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">\&gt;&quot;</span> /etc/passwd <span class="p">&amp;</span>&gt; /dev/null<span class="p">;</span><span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> not exist&quot;</span>
        <span class="nb">exit</span> <span class="m">62</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>id -u <span class="nv">$userName</span><span class="sb">`</span> -eq <span class="sb">`</span>id -g <span class="nv">$userName</span><span class="sb">`</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is good guy&quot;</span>
<span class="k">else</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is bad guy&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<ul class="simple">
<li>判断当前系统的所有用户是goodguy还是badguy</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">for</span> userName in <span class="sb">`</span>cut -d: -f1 /etc/passwd<span class="sb">`</span><span class="p">;</span><span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>id -u <span class="nv">$userName</span><span class="sb">`</span> -eq <span class="sb">`</span>id -g <span class="nv">$userName</span><span class="sb">`</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is good guy&quot;</span>
        <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is bad guy&quot;</span>
        <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现如下功能</p>
<blockquote>
<div><ul class="simple">
<li>1、添加10个用户stu1-stu10；但要先判断用户是否存在</li>
<li>2、如果存在，就用红色显示其已经存大在</li>
<li>3、否则，就添加此用户；并绿色显示</li>
<li>4、最后显示一共添加了几个用户</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">declare</span> -i <span class="nv">userCount</span><span class="o">=</span><span class="m">0</span>

<span class="k">for</span> i in <span class="o">{</span><span class="m">1</span>..10<span class="o">}</span><span class="p">;</span><span class="k">do</span>
        <span class="k">if</span> grep <span class="s2">&quot;^stu</span><span class="nv">$i</span><span class="s2">\&gt;&quot;</span> /etc/passwd <span class="p">&amp;</span>&gt; /dev/null<span class="p">;</span><span class="k">then</span>
                <span class="nb">echo</span> -e <span class="s2">&quot;\033[31mstu</span><span class="nv">$i</span><span class="s2">\033[0m exist&quot;</span>
        <span class="k">else</span>
                useradd stu<span class="nv">$i</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> -e <span class="s2">&quot;useradd \033[32mstu</span><span class="nv">$i</span><span class="s2">\033[0m finished&quot;</span>
                <span class="nb">let</span> userCount++
        <span class="k">fi</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&quot;Add </span><span class="nv">$userCount</span><span class="s2"> users&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li>判断当前系统中所有用户是否拥有可登录shell</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">for</span> userName in <span class="sb">`</span>cut -d: -f1 /etc/passwd<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="sb">`</span>grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">\&gt;&quot;</span> /etc/passwd <span class="p">|</span> cut -d: -f7<span class="sb">`</span> <span class="o">=</span>~ sh$ <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;login shell user: </span><span class="nv">$userName</span><span class="s2">&quot;</span>
        <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">&quot;nologin shell user: </span><span class="nv">$userName</span><span class="s2">&quot;</span>
        <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现如下功能</p>
<blockquote>
<div><ul>
<li><p class="first">1.显示如下菜单</p>
<blockquote>
<div><ul class="simple">
<li>cpu) show cpu info</li>
<li>mem) show memory info</li>
<li>quit) quit</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">2.如果用户选择cpu，则显示/proc/cpuinfo的信息</p>
</li>
<li><p class="first">3.如果用户选择mem，则显示/proc/meminfo的信息</p>
</li>
<li><p class="first">4.如果用户选择quit，则退出，且退出码为5</p>
</li>
<li><p class="first">5.如果用户键入其它字符，则显示未知选项，请重新输入</p>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">info</span><span class="o">=</span><span class="s2">&quot;cpu) show cpu info\nmem) show memory info\nquit) quit&quot;</span>
<span class="k">while</span> true<span class="p">;</span><span class="k">do</span>
        <span class="nb">echo</span> -e <span class="nv">$info</span>

        <span class="nb">read</span> -p <span class="s2">&quot;Enter your option: &quot;</span> userOption
        <span class="nv">userOption</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$userOption</span> <span class="p">|</span> tr <span class="s1">&#39;A-Z&#39;</span> <span class="s1">&#39;a-z&#39;</span><span class="sb">`</span>

        <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$userOption</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                cat /proc/cpuinfo
        <span class="k">elif</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$userOption</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;mem&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                cat /proc/meminfo
        <span class="k">elif</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$userOption</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;quit&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;quit&quot;</span>
                <span class="nv">retValue</span><span class="o">=</span><span class="m">5</span>
                <span class="nb">break</span>
        <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">&quot;unkown option&quot;</span>
                <span class="nv">retValue</span><span class="o">=</span><span class="m">6</span>
        <span class="k">fi</span>
<span class="k">done</span>

<span class="o">[</span> -z <span class="nv">$retValue</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">retValue</span><span class="o">=</span><span class="m">0</span>

<span class="nb">exit</span> <span class="nv">$retValue</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现如下功能</p>
<blockquote>
<div><ul class="simple">
<li>1.分别复制/var/log下的文件至/tmp/logs目录中</li>
<li>2.复制目录时，使用cp -r</li>
<li>3.复制文件时，使用cp</li>
<li>4.复制链接文件时，使用cp -d</li>
<li>5.余下的类型，使用cp -a</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">targetDir</span><span class="o">=</span><span class="s1">&#39;/tmp/logs&#39;</span>

<span class="o">[</span> -e <span class="nv">$targetDir</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> mkdir -p <span class="nv">$targetDir</span>

<span class="k">for</span> fileName in /var/log/*<span class="p">;</span><span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$fileName</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nv">copyCmd</span><span class="o">=</span><span class="s1">&#39;cp -r&#39;</span>
        <span class="k">elif</span> <span class="o">[</span> -f <span class="nv">$fileName</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nv">copyCmd</span><span class="o">=</span><span class="s1">&#39;cp&#39;</span>
        <span class="k">elif</span> <span class="o">[</span> -h <span class="nv">$fileName</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nv">copyCmd</span><span class="o">=</span><span class="s1">&#39;cp -d&#39;</span>
        <span class="k">else</span>
                <span class="nv">copyCmd</span><span class="o">=</span><span class="s1">&#39;cp -a&#39;</span>
        <span class="k">fi</span>

        <span class="nv">$copyCmd</span> <span class="nv">$fileName</span> <span class="nv">$targetDir</span>
<span class="k">done</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，使用形式：<code class="docutils literal"><span class="pre">userinfo.sh</span> <span class="pre">-u</span> <span class="pre">username</span> <span class="pre">[-v</span> <span class="pre">{1|2}]</span></code></p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">-u</span></code>选项用于指定用户，而后脚本显示用户的UID和GID</li>
<li><code class="docutils literal"><span class="pre">-v</span></code>选项后面是1，则显示用户的家目录路径；如果是2，则显示用户的家目录路径和shell</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="o">[</span> <span class="nv">$#</span> -lt <span class="m">2</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;less arguments&quot;</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">3</span>

<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;-u&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">userName</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
        <span class="nb">shift</span> <span class="m">2</span>       <span class="c1"># 剔除前2个位置参数</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$#</span> -ge <span class="m">2</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;-v&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">verFlag</span><span class="o">=</span><span class="nv">$2</span>
<span class="k">fi</span>

<span class="nv">verFlag</span><span class="o">=</span><span class="si">${</span><span class="nv">verFlag</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span>

<span class="k">if</span> <span class="o">[</span> -n <span class="nv">$verFlag</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="k">if</span> ! <span class="o">[[</span> <span class="nv">$verFlag</span> <span class="o">=</span>~ <span class="o">[</span><span class="m">012</span><span class="o">]</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;Wrong Parameter&quot;</span>
                <span class="nb">echo</span> <span class="s2">&quot;Usage: `basename </span><span class="nv">$0</span><span class="s2">` -u UserName -v {1|2}&quot;</span>
                <span class="nb">exit</span> <span class="m">4</span>
        <span class="k">fi</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$verFlag</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
        grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">&quot;</span> /etc/passwd <span class="p">|</span> cut -d: -f1,3,4,6
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$verFlag</span> -eq <span class="m">2</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
        grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">&quot;</span> /etc/passwd <span class="p">|</span> cut -d: -f1,3,4,6,7
<span class="k">else</span>
        grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">&quot;</span> /etc/passwd <span class="p">|</span> cut -d: -f1,3,4
<span class="k">fi</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现功能如下</p>
<blockquote>
<div><ul class="simple">
<li>提示用户输入一个用户名，判断用户是否登录了当前系统</li>
<li>如果没有登录，则停止5秒之后，再次判定；直到用户登陆系统，显示用户来了，然后退出</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">read</span> -p <span class="s2">&quot;Enter a user name: &quot;</span> userName

<span class="c1"># 判断输入是否为空并且是否存在该用户</span>
<span class="k">until</span> <span class="o">[</span> -n <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> id <span class="nv">$userName</span> <span class="p">&amp;</span>&gt; /dev/null<span class="p">;</span> <span class="k">do</span>
        <span class="nb">read</span> -p <span class="s2">&quot;Enter a user name again: &quot;</span> userName
<span class="k">done</span>

<span class="k">until</span> who <span class="p">|</span> grep <span class="s2">&quot;^</span><span class="nv">$userName</span><span class="s2">&quot;</span> <span class="p">&amp;</span>&gt; /dev/null<span class="p">;</span> <span class="k">do</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is offline&quot;</span>
        sleep <span class="m">5</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$userName</span><span class="s2"> is online&quot;</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现功能如下</p>
<blockquote>
<div><ul class="simple">
<li>1.提示用户输入一个磁盘设备文件路径不存在或不是一个块设备，则提示用户重新输入，知道输入正确为止，或者输入quit以9为退出码结束脚本</li>
<li>2.提示用户”下面的操作会清空磁盘的数据，并提问是否继续”。如果用户给出字符y或yes，则继续，否则，则提供以8为退出码结束脚本</li>
<li>3.将用户指定的磁盘上的分区清空，而后创建两个分区，大小分别为100M和512M</li>
<li>4.格式化这两个分区</li>
<li>5.将第一个分区挂载至/mnt/boot目录，第二个分区挂载至/mnt/sysroot目录</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="c1">#！/bin/bash</span>
<span class="nb">read</span> -p <span class="s2">&quot;Enter you dev &quot;</span> devdir
umonut /mnt/boot
umonut /mnt/sysroot

<span class="k">while</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$devdir</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;quit&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">do</span>
        <span class="o">[</span> -a <span class="nv">$devdir</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> -b <span class="nv">$devdir</span> <span class="o">]</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                <span class="nb">read</span> -p <span class="s2">&quot;Are you sure[y|yes]: &quot;</span> option
                <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$option</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span> <span class="o">||</span> <span class="s2">&quot;</span><span class="nv">$option</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                        dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span><span class="nv">$devdir</span> <span class="nv">bs</span><span class="o">=</span><span class="m">512</span> <span class="nv">count</span><span class="o">=</span><span class="m">1</span> <span class="p">&amp;</span>&gt; /dev/null
                        <span class="nb">echo</span> -e <span class="s2">&quot;n\np\n1\n\n+100M\nn\np\n2\n\n+512M\nw&quot;</span> <span class="p">|</span> fdisk <span class="nv">$devdir</span>
                        mke2fs -t ext4 <span class="si">${</span><span class="nv">devdir</span><span class="si">}</span><span class="m">1</span>
                        mke2fs -t ext4 <span class="si">${</span><span class="nv">devdir</span><span class="si">}</span><span class="m">2</span>
                        mount <span class="si">${</span><span class="nv">devdir</span><span class="si">}</span><span class="m">1</span> /mnt/boot
                        mount <span class="si">${</span><span class="nv">devdir</span><span class="si">}</span><span class="m">2</span> /mnt/sysroot
                        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">devdir</span><span class="si">}</span><span class="s2">1 /mnt/boot ext4 default 0 0&quot;</span> &gt;&gt; /etc/fstab
                        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">devdir</span><span class="si">}</span><span class="s2">2 /mnt/sysroot ext4 default 0 0&quot;</span> &gt;&gt; /etc/fstab
                        <span class="nb">exit</span> <span class="m">7</span>
                <span class="k">else</span>
                        <span class="nb">exit</span> <span class="m">8</span>
                <span class="k">fi</span>
    <span class="k">else</span>
        <span class="nb">read</span> -p <span class="s2">&quot;Enter you dev again:　&quot;</span>　devdir
    <span class="k">fi</span>
<span class="k">done</span>

<span class="nb">exit</span> <span class="m">9</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现功能如下</p>
<blockquote>
<div><ul class="simple">
<li>提示用户输入一个目录路径</li>
<li>显示目录下至少包含一个大写字母的文件名</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="c1">#！/bin/bash</span>

<span class="k">while</span> true<span class="p">;</span> <span class="k">do</span>
        <span class="nb">read</span> -p <span class="s2">&quot;Enter a directory: &quot;</span> dirname
        <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$dirname</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;quit&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">3</span>
        <span class="o">[</span> -d <span class="s2">&quot;</span><span class="nv">$dirname</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">&quot;wrong directory...&quot;</span>
<span class="k">done</span>

<span class="k">for</span> filename in <span class="nv">$dirname</span>/*<span class="p">;</span><span class="k">do</span>
        <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$fileName</span><span class="s2">&quot;</span> <span class="o">=</span>~ .*<span class="o">[[</span>:upper:<span class="o">]]{</span><span class="m">1</span>,<span class="o">}</span>.* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$fileName</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现功能如下(前提是配置好yum源)</p>
<blockquote>
<div><ul class="simple">
<li>1、如果本机没有一个可用的yum源，则提示用户，并退出脚本(4)；如果此脚本非以root用户执行，则显示仅有root才有权限安装程序包，而后退出(3)</li>
<li>2、提示用户输入一个程序包名称，而后使用yum自动安装之；尽可能不输出yum命令执行中的信息；如果安装成功，则绿色显示，否则，红色显示失败</li>
<li>3、如果用户输入的程序包不存在，则显示错误后让用户继续输入</li>
<li>4、如果用户输入quit，则正常退出(0)</li>
<li>5、正常退出前，显示本地共安装的程序包的个数</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">while</span> true<span class="p">;</span><span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$UID</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;`basename </span><span class="nv">$0</span><span class="s2">` must be running as root&quot;</span>
                <span class="nb">exit</span> <span class="m">3</span>
        <span class="k">fi</span>

        yum repolist <span class="p">&amp;</span>&gt; /dev/null
        <span class="k">if</span>  <span class="o">[[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                <span class="k">while</span> true<span class="p">;</span> <span class="k">do</span>
                        <span class="nb">read</span> -p <span class="s2">&quot;Enter a pakage: &quot;</span> pacName
                        <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$pacName</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;quit&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                                rpm -qa <span class="p">|</span> wc -l
                                <span class="nb">exit</span> <span class="m">0</span>
                <span class="k">fi</span>

                        yum list <span class="p">|</span> grep <span class="s2">&quot;^</span><span class="nv">$pacName</span><span class="s2">.*&quot;</span> <span class="p">&amp;</span>&gt; /dev/null
                <span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                        yum install <span class="nv">$pacName</span> -y <span class="p">&amp;</span>&gt; /dev/null
                        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
                                <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$pacName</span><span class="s2"> install fail&quot;</span>
                        <span class="k">else</span>
                                <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$pacName</span><span class="s2"> install success&quot;</span>
                        <span class="k">fi</span>
                <span class="k">else</span>
                        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$pacName</span><span class="s2"> is not exist&quot;</span>
                        <span class="k">continue</span>
                <span class="k">fi</span>
                <span class="k">done</span>
        <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">&quot;yum repo is not ok!&quot;</span>
                <span class="nb">exit</span> <span class="m">4</span>
        <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，完成功能如下</p>
<blockquote>
<div><ul class="simple">
<li>1.提示用户输入一个nice值</li>
<li>2.显示指定nice指定进程名及pid</li>
<li>3.提示用户选择要修改nice值的进程的pid和nice值</li>
<li>4.执行修改</li>
<li>5.别退出，继续修改</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$UID</span> -eq <span class="m">0</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
   <span class="nb">echo</span> <span class="s2">&quot;keyi suibian tiao nice !&quot;</span>
<span class="k">else</span>
   <span class="nb">echo</span> <span class="s2">&quot;zhineng tiaoda nice !&quot;</span>
<span class="k">fi</span>

<span class="k">while</span> true<span class="p">;</span><span class="k">do</span>
        <span class="nb">read</span> -p <span class="s2">&quot;Enter a nice : &quot;</span> nicename
        <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$nicename</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;quit&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">3</span>
        /bin/ps axo nice,user,command,pid<span class="p">|</span> grep <span class="s2">&quot;^[[:space:]]</span><span class="si">${</span><span class="nv">nicename</span><span class="si">}</span><span class="s2">\&gt;&quot;</span>
        <span class="nb">read</span> -p <span class="s2">&quot;Enter a nice : &quot;</span> niceid
        <span class="nb">read</span> -p <span class="s2">&quot;Ener a PID :　&quot;</span> pidid
        /usr/bin/renice <span class="nv">$niceid</span> <span class="nv">$pidid</span>
<span class="k">done</span>
</pre></div>
</div>
<ul>
<li><p class="first">写一个脚本，实现功能如下：能对/etc/进行打包备份，备份位置为/backup/etc-日期.后缀</p>
<blockquote>
<div><ul>
<li><p class="first">1.显示如下菜单给用户</p>
<blockquote>
<div><ul class="simple">
<li>xz) xz compress</li>
<li>gzip) gzip compress</li>
<li>bzip2) bzip2 compress</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">2.根据用户指定的压缩工具使用tar打包压缩</p>
</li>
<li><p class="first">3.默认为xz，输入错误则需要用户重新输入</p>
</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># 方法一</span>
<span class="o">[</span> -d /backup <span class="o">]</span> <span class="o">||</span> mkdir /backup
cat <span class="s">&lt;&lt; EOF</span>
<span class="s">xz) xz compress</span>
<span class="s">gzip) gzip compress</span>
<span class="s">bzip2) bzip2 compress</span>
<span class="s">EOF</span>

<span class="k">while</span> true<span class="p">;</span><span class="k">do</span>
        <span class="nb">read</span> -p <span class="s2">&quot;Enter a options :&quot;</span> tarname
        <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$tarname</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;quit&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">exit</span> <span class="m">5</span>
        <span class="nv">tarname</span><span class="o">=</span><span class="si">${</span><span class="nv">tarname</span><span class="k">:-</span><span class="nv">xz</span><span class="si">}</span>               <span class="c1"># tarname为空时给定默认值</span>

        <span class="k">case</span> <span class="nv">$tarname</span> in
                xz<span class="o">)</span>
                        tar Jcf /backup/etc-<span class="sb">`</span>date +%F-%H-%M-%S<span class="sb">`</span>.tar.xz /etc/*
                        <span class="nb">break</span>
                        <span class="p">;;</span>
                gzip<span class="o">)</span>
                        tar zcf /backup/etc-<span class="sb">`</span>date +%F-%H-%M-%S<span class="sb">`</span>.tar.gz /etc/*
                        <span class="nb">break</span>
                        <span class="p">;;</span>
                bzip2<span class="o">)</span>
                        tar jcf /backup/etc-<span class="sb">`</span>date +%F-%H-%M-%S<span class="sb">`</span>.tar.bz2 /etc/*
                        <span class="nb">break</span>
                        <span class="p">;;</span>
                *<span class="o">)</span>
                        <span class="nb">echo</span> <span class="s2">&quot;you Enter is wrong option!&quot;</span>
        <span class="k">esac</span>
<span class="k">done</span>


<span class="c1"># 方法二</span>

<span class="c1">#!/bin/bash</span>

<span class="o">[</span> -d /backup <span class="o">]</span> <span class="o">||</span> mkdir /backup

cat <span class="s">&lt;&lt; EOF</span>
<span class="s">plz choose a compress tool:</span>

<span class="s">xz) xz compress</span>
<span class="s">gzip) gzip compress</span>
<span class="s">bzip2) bzip2 compress</span>
<span class="s">EOF</span>

<span class="k">while</span> true<span class="p">;</span> <span class="k">do</span>
        <span class="nb">read</span> -p <span class="s2">&quot;your optopn: &quot;</span> option
        <span class="nv">option</span><span class="o">=</span><span class="si">${</span><span class="nv">option</span><span class="k">:-</span><span class="nv">xz</span><span class="si">}</span>

        <span class="k">case</span> <span class="nv">$option</span> in
        xz<span class="o">)</span>
                <span class="nv">compressTool</span><span class="o">=</span><span class="s2">&quot;J&quot;</span>
                <span class="nv">suffix</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span>
                <span class="nb">break</span>
                <span class="p">;;</span>
        gzip<span class="o">)</span>
                <span class="nv">compressTool</span><span class="o">=</span><span class="s2">&quot;z&quot;</span>
                <span class="nv">suffix</span><span class="o">=</span><span class="s1">&#39;gz&#39;</span>
                <span class="nb">break</span>
                <span class="p">;;</span>
        bzip2<span class="o">)</span>
                <span class="nv">compressTool</span><span class="o">=</span><span class="s2">&quot;j&quot;</span>
                <span class="nv">suffix</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span>
                <span class="nb">break</span>
                <span class="p">;;</span>
        *<span class="o">)</span>
                <span class="nb">echo</span> <span class="s2">&quot;wrong option&quot;</span>
                <span class="p">;;</span>
        <span class="k">esac</span>
<span class="k">done</span>

tar <span class="si">${</span><span class="nv">compressTool</span><span class="si">}</span>cf /backup/etc-<span class="sb">`</span>date +%F-%H-%M-%S<span class="sb">`</span>.tar.<span class="nv">$suffix</span> /etc/*
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="1-usescript.html" class="btn btn-neutral float-right" title="实用脚本" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="脚本示例" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, HappyAnony.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>